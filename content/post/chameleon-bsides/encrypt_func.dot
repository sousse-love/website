digraph GRAPH_0 {

  // Generated by Graph::Easy 0.76 at Fri Feb 28 22:49:11 2020

  edge [ arrowhead=normal,     fontname="Source Code Pro" ];
  graph [
    label="Graph of encrypt",
    fontname="Source Code Pro",
    labelloc=top ];
  node [
    fillcolor=white,
    fontsize=11,
    fontname="Source Code Pro"
    shape=box,
    style=filled ];

  0 [ label="encrypt:\lsub     esp, 2Ch\lmov     eax, ___security_cookie\lxor     eax, esp\lmov     [esp+2Ch+var_4], eax\lmov     eax, [esp+2Ch+input]; filename\llea     ecx, [esp+2Ch+pdwDataLen]\lpush    esi\lpush    ecx; lpNumberOfBytesRead\lcall    read_file\lmov     edx, [esp+34h+pdwDataLen]\ladd     edx, 10h\lpush    edx; NewSize\lpush    eax; Memory\lcall    ds:realloc\ladd     esp, 0Ch\lpush    0F0000000h; dwFlags\lpush    1; dwProvType\lpush    offset szProvider; \"Microsoft Enhanced Cryptographic Provid\"... \lmov     esi, eax \lpush    0; szContainer \llea     eax, [esp+40h+phProv] \lpush    eax; phProv \lcall    ds:CryptAcquireContextA \ltest    \leax, eax jnz     \lshort loc_E5202D\l", rank=0 ]
  1 [ label="push    offset aEncryptionFail; \"Encryption failed\l\" call    ds:__iob_func add     eax, 40h push    eax; File call    ds:fprintf add     esp, 8 push    1; Code call    ds:exit\l", rank=5 ]
  2 [ label="push    edi\llea     edi, [esp+34h+var_C]\lcall    mersenne_twister\lmov     edx, dword ptr [esp+34h+var_C]\lxor     ecx, ecx\lmov     word ptr [esp+34h+pbData+2], cx\llea     ecx, [esp+34h+phKey]\lpush    ecx; phKey\lpush    1; dwFlags\lmov     eax, 8\lpush    0; hPubKey\lmov     [esp+40h+pbData], al\lmov     dword ptr [esp+40h+pbData+8], eax\lmov     eax, dword ptr [esp+40h+var_C+4]\lmov     dword ptr [esp+40h+pbData+0Ch], edx\lpush    14h; dwDataLen\llea     edx, [esp+44h+pbData]\lmov     dword ptr [esp+44h+pbData+10h], eax\lmov     eax, [esp+44h+phProv]\lpush    edx; pbData\lpush    eax; hProv\lmov     [esp+4Ch+pbData+1], 2\lmov     dword ptr [esp+4Ch+pbData+4], 6601h\lcall    ds:CryptImportKey\lpop     edi\ltest    eax, eax\ljz      short loc_E5200D\l" ]
  3 [ label="mov     ecx, [esp+30h+pdwDataLen]\lmov     eax, [esp+30h+phKey]\ladd     ecx, 8\lpush    ecx; dwBufLen\llea     edx, [esp+34h+pdwDataLen]\lpush    edx; pdwDataLen\lpush    esi; pbData\lpush    0; dwFlags\lpush    1; Final\lpush    0; hHash\lpush    eax; hKey\lcall    ds:CryptEncrypt\ltest    eax, eax\ljz      loc_E5200D\l" ]
  4 [ label="lea     ecx, [esp+30h+var_C]\lpush    ecx; key\lcall    sub_E51AA0\lmov     edx, [esp+34h+pdwDataLen]\lpush    edx\lpush    esi\lmov     eax, ebx\lcall    sub_E51F50\lpush    esi; Memory\lcall    ds:free\lmov     ecx, [esp+40h+var_4]\ladd     esp, 10h\lpop     esi\lxor     ecx, esp\lcall    @__security_check_cookie@4; __security_check_cookie(x)\ladd     esp, 2Ch\lretn\l", rank=5 ]

  0 -> 2 [ color="#008000", fontcolor="#008000", label=true ]
  0 -> 1 [ color="#ff0000", fontcolor="#ff0000", label=false ]
  2 -> 3 [ color="#ff0000", fontcolor="#ff0000", label=false ]
  2 -> 1 [ color="#008000", fontcolor="#008000", label=true ]
  3 -> 4 [ color="#ff0000", fontcolor="#ff0000", label=false ]
  3 -> 1 [ color="#008000", fontcolor="#008000", label=true ]

}
